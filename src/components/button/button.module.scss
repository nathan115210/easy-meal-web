@use '@styles/tokens/colors' as *;
@use '@styles/tokens/spacing' as *;
@use '@styles/tokens/border-radius' as *;

/* Base button */

.button {
  /* Layout */
  --btn-padding-y: #{pxToRem(8)};
  --btn-padding-x: #{pxToRem(14)};
  --btn-font-size: #{pxToRem(14)};
  --btn-radius: #{$radius-lg};
  --btn-gap: #{pxToRem(8)};
  --btn-border-width: 1px;

  /* Default (primary-ish) colors – will be overridden by variants */
  --btn-bg: #{$color-primary};
  --btn-fg: #{$color-primary-foreground};
  --btn-border-color: #{$color-primary};

  --btn-bg-hover: color-mix(in srgb, #{$color-primary} 85%, #{$color-background} 15%);
  --btn-fg-hover: #{$color-primary-foreground};
  --btn-border-hover: #{$color-primary};

  --btn-bg-active: color-mix(in srgb, #{$color-primary} 75%, #{$color-background} 25%);
  --btn-fg-active: #{$color-primary-foreground};
  --btn-border-active: #{$color-primary};

  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--btn-gap);
  padding: var(--btn-padding-y) var(--btn-padding-x);
  font-size: var(--btn-font-size);
  font-weight: 500;
  line-height: 1.2;
  border-radius: var(--btn-radius);
  border: var(--btn-border-width) solid var(--btn-border-color);
  background: var(--btn-bg);
  color: var(--btn-fg);
  cursor: pointer;
  white-space: nowrap;
  text-decoration: none;
  user-select: none;
  transition:
    background 0.15s ease,
    color 0.15s ease,
    border-color 0.15s ease,
    box-shadow 0.15s ease,
    transform 0.05s ease;

  &:focus-visible {
    outline: 2px solid $color-primary;
    outline-offset: 2px;
  }

  &:hover:not(:disabled):not(.is-loading) {
    background: var(--btn-bg-hover);
    color: var(--btn-fg-hover);
    border-color: var(--btn-border-hover);
  }

  &:active:not(:disabled):not(.is-loading) {
    background: var(--btn-bg-active);
    color: var(--btn-fg-active);
    border-color: var(--btn-border-active);
    transform: translateY(0.5px);
  }

  &:disabled,
  &[aria-disabled='true'] {
    opacity: 0.5;
    cursor: not-allowed;
  }
}

/* ───── Sizes ───── */

.button--sm {
  --btn-padding-y: #{pxToRem(4)};
  --btn-padding-x: #{pxToRem(10)};
  --btn-font-size: #{pxToRem(13)};
}

.button--lg {
  --btn-padding-y: #{pxToRem(10)};
  --btn-padding-x: #{pxToRem(18)};
  --btn-font-size: #{pxToRem(15)};
}

/* Compact = label-like pill, minimal padding */
.button--compact {
  --btn-padding-y: #{pxToRem(2)};
  --btn-padding-x: #{pxToRem(6)};
  --btn-font-size: #{pxToRem(12)};
  --btn-radius: #{$radius-xl};
}

/* Icon-only = square-ish */
.button--icon-only {
  --btn-padding-y: #{pxToRem(6)};
  --btn-padding-x: #{pxToRem(6)};
  min-width: pxToRem(32);
  min-height: pxToRem(32);
}

/* Loading state */

.is-loading {
  cursor: progress;
}

/* Spinner */

.spinner {
  inline-size: pxToRem(16);
  block-size: pxToRem(16);
  border-radius: 50%;
  border: 2px solid rgba(0, 0, 0, 0.15);
  border-top-color: currentColor;
  animation: spinner-rotate 0.6s linear infinite;
}

@keyframes spinner-rotate {
  to {
    transform: rotate(360deg);
  }
}

/* Screen-reader only */

.sr-only {
  position: absolute;
  inline-size: 1px;
  block-size: 1px;
  padding: 0;
  margin: -1px;
  border: 0;
  overflow: hidden;
  white-space: nowrap;
  clip: rect(0 0 0 0);
  clip-path: inset(50%);
}

/* ───── Variants ───── */

/* Filled primary */

.button--primary {
  --btn-bg: #{$color-primary};
  --btn-fg: #{$color-primary-foreground};
  --btn-border-color: #{$color-primary};

  --btn-bg-hover: color-mix(in srgb, #{$color-primary} 85%, #{$color-background} 15%);
  --btn-fg-hover: #{$color-primary-foreground};
  --btn-border-hover: #{$color-primary};

  --btn-bg-active: color-mix(in srgb, #{$color-primary} 75%, #{$color-background} 25%);
  --btn-fg-active: #{$color-primary-foreground};
  --btn-border-active: #{$color-primary};
}

/* Filled secondary */

.button--secondary {
  --btn-bg: #{$color-secondary};
  --btn-fg: #{$color-secondary-foreground};
  --btn-border-color: #{$color-secondary};

  --btn-bg-hover: color-mix(in srgb, #{$color-secondary} 85%, #{$color-background} 15%);
  --btn-fg-hover: #{$color-secondary-foreground};
  --btn-border-hover: #{$color-secondary};

  --btn-bg-active: color-mix(in srgb, #{$color-secondary} 75%, #{$color-background} 25%);
  --btn-fg-active: #{$color-secondary-foreground};
  --btn-border-active: #{$color-secondary};
}

/* Primary outline */

.button--primary-outline {
  --btn-bg: transparent;
  --btn-fg: #{$color-primary};
  --btn-border-color: #{$color-primary};

  --btn-bg-hover: color-mix(in srgb, #{$color-primary} 8%, #{$color-background} 92%);
  --btn-fg-hover: #{$color-primary};
  --btn-border-hover: #{$color-primary};

  --btn-bg-active: color-mix(in srgb, #{$color-primary} 16%, #{$color-background} 84%);
  --btn-fg-active: #{$color-primary};
  --btn-border-active: #{$color-primary};
}

/* Secondary outline */

.button--secondary-outline {
  --btn-bg: transparent;
  --btn-fg: #{$color-secondary-foreground};
  --btn-border-color: #{$color-secondary};

  --btn-bg-hover: color-mix(in srgb, #{$color-secondary} 12%, #{$color-background} 88%);
  --btn-fg-hover: #{$color-secondary-foreground};
  --btn-border-hover: #{$color-secondary};

  --btn-bg-active: color-mix(in srgb, #{$color-secondary} 20%, #{$color-background} 80%);
  --btn-fg-active: #{$color-secondary-foreground};
  --btn-border-active: #{$color-secondary};
}

/* Ghost – minimal, used in toolbars, filters */

.button--ghost {
  --btn-bg: transparent;
  --btn-fg: #{$color-foreground};
  --btn-border-color: transparent;

  --btn-bg-hover: #{$color-background-secondary};
  --btn-fg-hover: #{$color-foreground};
  --btn-border-hover: transparent;

  --btn-bg-active: color-mix(in srgb, #{$color-border} 70%, #{$color-background} 30%);
  --btn-fg-active: #{$color-foreground};
  --btn-border-active: transparent;
}

/* Destructive – delete / remove */

.button--destructive {
  --btn-bg: #{$color-destructive};
  --btn-fg: #{$color-destructive-foreground};
  --btn-border-color: #{$color-destructive};

  --btn-bg-hover: color-mix(in srgb, #{$color-destructive} 85%, #{$color-background} 15%);
  --btn-fg-hover: #{$color-destructive-foreground};
  --btn-border-hover: #{$color-destructive};

  --btn-bg-active: color-mix(in srgb, #{$color-destructive} 75%, #{$color-background} 25%);
  --btn-fg-active: #{$color-destructive-foreground};
  --btn-border-active: #{$color-destructive};
}

/* Link-style button, used for inline actions */

.button--link {
  --btn-bg: transparent;
  --btn-fg: #{$color-primary};
  --btn-border-color: transparent;

  --btn-bg-hover: transparent;
  --btn-fg-hover: color-mix(in srgb, #{$color-primary} 90%, #{$color-foreground} 10%);
  --btn-border-hover: transparent;

  --btn-bg-active: transparent;
  --btn-fg-active: color-mix(in srgb, #{$color-primary} 80%, #{$color-foreground} 20%);
  --btn-border-active: transparent;

  padding-inline: 0;
  border-width: 0;
  text-decoration: underline;
  text-underline-offset: 2px;

  &:hover:not(:disabled):not(.is-loading),
  &:active:not(:disabled):not(.is-loading) {
    text-decoration-thickness: 2px;
  }
}
